% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Cell_type_neighborhood.R
\name{Cell_type_neighborhood}
\alias{Cell_type_neighborhood}
\title{Compute Local Cell Type Composition in the Spatial Neighborhood}
\usage{
Cell_type_neighborhood(
  sample_information_coordinate,
  resolution = c("single_cell", "spot"),
  sample_information_cellType = NULL,
  sample_information_decon = NULL,
  k = 50,
  r = 4
)
}
\arguments{
\item{sample_information_coordinate}{A data.frame or matrix of spatial coordinates (x, y).
Row names must correspond to cell or spot IDs.}

\item{resolution}{One of \code{"single_cell"} or \code{"spot"}.}

\item{sample_information_cellType}{Named vector of cell types for single-cell resolution.
Names must match rownames of \code{sample_information_coordinate}.}

\item{sample_information_decon}{A matrix of cell type proportions per spot (for \code{"spot"} mode).
Row names must match those of \code{sample_information_coordinate}.}

\item{k}{Integer, number of nearest neighbors (used only in \code{"single_cell"} mode). Default is 50.}

\item{r}{Numeric, distance threshold for neighborhood (used only in \code{"spot"} mode). Default is 4.}
}
\value{
A matrix of normalized cell type proportions for each spatial unit (rows) across cell types (columns).
}
\description{
Computes the local cell type composition for each spot or cell based on spatial
proximity. Supports both single-cell resolution using nearest neighbors and
spot-level resolution using distance thresholding with cell type proportions.
}
\details{
This function calculates the distribution of cell types around each spatial unit
using one of the following modes:
\itemize{
  \item \code{"single_cell"}: Uses discrete cell-type labels and K-nearest neighbors.
  \item \code{"spot"}: Uses continuous deconvolution proportions and radius threshold.
}

The returned matrix represents normalized cell-type compositions in each local neighborhood.
}
\examples{
\dontrun{
data("osmFISH_metadata_cellType")
data("osmFISH_bulk_decon")
data("osmFISH_bulk_pheno")
data("osmFISH_bulk_coordinate")

Cell_type_neighborhood(
  sample_information_coordinate = osmFISH_bulk_coordinate,
  resolution = "single_cell",
  sample_information_cellType = osmFISH_metadata_cellType
)

}

}
\author{
Bin Duan
}
