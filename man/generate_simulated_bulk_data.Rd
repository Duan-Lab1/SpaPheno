% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_simulated_bulk_data.R
\name{generate_simulated_bulk_data}
\alias{generate_simulated_bulk_data}
\title{Generate Simulated Pseudo-Bulk Data for Two Phenotypes}
\usage{
generate_simulated_bulk_data(
  input_data,
  region_labels,
  phenotypes,
  perturbation_percent = 0.1,
  num_samples = 50,
  mode = c("proportion", "expression"),
  seed = 123
)
}
\arguments{
\item{input_data}{A matrix or data.frame. For \code{mode = "expression"}, it should be a numeric matrix with rows as genes and columns as spots. For \code{"proportion"}, it can be a vector of cell types.}

\item{region_labels}{A named vector with phenotype labels. Names must match column names (spots) of \code{input_data}.}

\item{phenotypes}{A character vector of two phenotype labels to compare, e.g., \code{c("A", "B")}.}

\item{perturbation_percent}{Numeric; percentage (between 0 and 1) of random noise to add. Default is 0.1.}

\item{num_samples}{Integer; number of pseudo-bulk samples to generate for each phenotype. Default is 50.}

\item{mode}{Character; either \code{"expression"} or \code{"proportion"}. Default is \code{"proportion"}.}

\item{seed}{Integer; random seed for reproducibility. Default is 123.}
}
\value{
A list with two data.frames:
\itemize{
  \item First element: pseudo-bulk samples for phenotype I
  \item Second element: pseudo-bulk samples for phenotype II
}
}
\description{
Simulates pseudo-bulk data from single-cell or spatial transcriptomics input
by aggregating data across regions/phenotypes, with optional perturbation.
}
\details{
The function supports two modes:
\itemize{
  \item \code{"expression"}: Uses numeric expression matrix (e.g., genes Ã— spots).
  \item \code{"proportion"}: Uses categorical input (e.g., cell type labels) and converts to proportions.
}
For each phenotype group, the function randomly perturbs the data and averages columns to simulate
multiple pseudo-bulk samples. This is useful for benchmarking or downstream analysis.
}
\examples{
\dontrun{
# Simulate from gene expression matrix
gene_mat <- matrix(runif(1000), nrow = 100, ncol = 10)
colnames(gene_mat) <- paste0("Spot", 1:10)
labels <- setNames(rep(c("A", "B"), each = 5), colnames(gene_mat))
result <- generate_simulated_bulk_data(
  input_data = gene_mat,
  region_labels = labels,
  phenotypes = c("A", "B"),
  mode = "expression"
)

data("osmFISH_metadata_cellType")
data("osmFISH_metadata_region")
data("osmFISH_phenotype_simu")
pseudo_bulk_simi <- generate_simulated_bulk_data(
  input_data = osmFISH_metadata_cellType,
  region_labels = osmFISH_metadata_region,
  phenotypes = osmFISH_phenotype_simu,
  perturbation_percent = 0.1,
  num_samples = 50,
  mode = "proportion")

head(pseudo_bulk_simi[[1]])
}

}
\author{
Bin Duan
}
