% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PhenotypeHclust.R
\name{PhenotypeHclust}
\alias{PhenotypeHclust}
\title{Phenotype-based Hierarchical Clustering and Visualization of Cell Type Distributions}
\usage{
PhenotypeHclust(
  PhenotypeMap_result,
  phenotype = c("phenotype-", "phenotype+"),
  coordinate,
  k = 2,
  size = 2
)
}
\arguments{
\item{PhenotypeMap_result}{A list with at least:
\itemize{
  \item \code{cell_type_distribution}: Matrix or data.frame of cell type proportions (rows = spots).
  \item \code{pred_score}: Data.frame with phenotype labels. Row names must match the distribution matrix.
}}

\item{phenotype}{Character string indicating phenotype label to subset. Default is \code{"phenotype-"}.}

\item{coordinate}{A data.frame of spatial coordinates for each spot/cell. Used for spatial plotting.}

\item{k}{Integer; number of clusters/domains to define. Default is 2.}

\item{size}{Numeric; point size used in \code{SpaDo::DomainPlot}. Default is 2.}
}
\value{
A \code{ggplot2} object displaying mean cell type proportions per identified domain.
}
\description{
This function performs phenotype-stratified hierarchical clustering of cell type proportions
using Jensen-Shannon Divergence (JSD) as the distance metric. It then visualizes average
cell type distributions across identified clusters/domains.
}
\details{
The function filters spots/cells by a specified phenotype label, computes pairwise JSD distances,
applies hierarchical clustering, and visualizes the mean cell type profiles of each domain.
Requires the \code{SpaDo} package for clustering and plotting domains. devtools::install_github("bm2-lab/SpaDo").
}
\examples{
\dontrun{
res <- list(
  cell_type_distribution = cell_type_df,
  pred_score = phenotype_df
)
PhenotypeHclust(res, phenotype = "phenotype+", coordinate = coord_df, k = 3)
}

}
\author{
Bin Duan
}
