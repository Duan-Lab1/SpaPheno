% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PhenotypePlot.R
\name{PhenotypePlot}
\alias{PhenotypePlot}
\title{Plot Spatial Phenotype Significance Map with Permutation Thresholds}
\usage{
PhenotypePlot(coordinate, prediction, permutation, size = 1, p = 0.01)
}
\arguments{
\item{coordinate}{A data.frame or matrix with two columns (x, y). Row names should match prediction order.}

\item{prediction}{A numeric vector of phenotype prediction scores for each spatial unit.}

\item{permutation}{A numeric vector from the permutation null distribution.}

\item{size}{Numeric; point size in the spatial plot. Default is 1.}

\item{p}{Numeric; two-sided significance level (between 0 and 1). Default is 0.01.}
}
\value{
A combined \code{ggplot2} visualization with spatial points and a legend,
rendered using \code{gridExtra::grid.arrange}.
}
\description{
Visualizes phenotype prediction scores in spatial coordinates and highlights spatial units
with statistically significant scores based on permutation-derived null distributions.
}
\details{
Points with scores above the upper threshold (top \code{1 - p}) are shown in shades of red,
and those below the lower threshold (bottom \code{p}) in shades of blue. Non-significant points
are shown in gray. A separate side legend visualizes the score gradient and labels for phenotype interpretation.
}
\examples{
\dontrun{
set.seed(123)
coords <- data.frame(x = runif(100), y = runif(100))
pred <- rnorm(100)
perm <- rnorm(1000)
PhenotypePlot(coords, pred, perm)
}

}
\author{
Bin Duan
}
