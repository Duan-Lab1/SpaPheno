<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Linking Spatial Transcriptomics to Clinical Phenotypes with Interpretable Machine Learning • SpaPheno</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Linking Spatial Transcriptomics to Clinical Phenotypes with Interpretable Machine Learning">
<meta name="description" content="an R package designed to identify, visualize, and interpret spatial phenotype associations from spatial transcriptomics and simulated bulk data. Linking spatial transcriptomic patterns to clinically relevant phenotypes is a critical step toward spatially informed precision oncology. Here, we introduce SpaPheno, an interpretable machine learning framework that integrates spatial transcriptomics with clinically annotated bulk RNA-seq data to uncover spatially resolved biomarkers predictive of patient outcomes. Leveraging Elastic Net regression combined with SHAP-based attribution, SpaPheno uniquely identifies spatial features at multiple scales—from tissue regions to specific cell types and individual spatial spots—that are associated with patient survival, tumor stage, and immunotherapy response. We demonstrate the robustness and generalizability of SpaPheno through comprehensive simulations and applications spanning primary liver cancer, clear cell renal cell carcinoma, breast cancer, and melanoma. Across these diverse settings, SpaPheno achieves high predictive accuracy while providing biologically meaningful and spatially precise interpretations. Our framework offers a powerful and extensible approach for translating complex spatial omics data into actionable clinical insights, accelerating the development of precision oncology strategies grounded in tumor spatial architecture.">
<meta property="og:description" content="an R package designed to identify, visualize, and interpret spatial phenotype associations from spatial transcriptomics and simulated bulk data. Linking spatial transcriptomic patterns to clinically relevant phenotypes is a critical step toward spatially informed precision oncology. Here, we introduce SpaPheno, an interpretable machine learning framework that integrates spatial transcriptomics with clinically annotated bulk RNA-seq data to uncover spatially resolved biomarkers predictive of patient outcomes. Leveraging Elastic Net regression combined with SHAP-based attribution, SpaPheno uniquely identifies spatial features at multiple scales—from tissue regions to specific cell types and individual spatial spots—that are associated with patient survival, tumor stage, and immunotherapy response. We demonstrate the robustness and generalizability of SpaPheno through comprehensive simulations and applications spanning primary liver cancer, clear cell renal cell carcinoma, breast cancer, and melanoma. Across these diverse settings, SpaPheno achieves high predictive accuracy while providing biologically meaningful and spatially precise interpretations. Our framework offers a powerful and extensible approach for translating complex spatial omics data into actionable clinical insights, accelerating the development of precision oncology strategies grounded in tumor spatial architecture.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SpaPheno</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/SpaPheno-tutorial.html">SpaPheno Tutorial: Linking Spatial Transcriptomics to Clinical Phenotypes with Interpretable Machine Learning</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/Duan-Lab1/SpaPheno/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="spapheno-linking-spatial-transcriptomics-to-clinical-phenotypes-with-interpretable-machine-learning">SpaPheno: Linking Spatial Transcriptomics to Clinical Phenotypes with Interpretable Machine Learning<a class="anchor" aria-label="anchor" href="#spapheno-linking-spatial-transcriptomics-to-clinical-phenotypes-with-interpretable-machine-learning"></a>
</h1></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>SpaPheno</strong> is an R package designed to identify, visualize, and interpret spatial phenotype associations from spatial transcriptomics and simulated bulk data.</p>
<p>Linking spatial transcriptomic patterns to clinically relevant phenotypes is a critical step toward spatially informed precision oncology. Here, we introduce SpaPheno, an interpretable machine learning framework that integrates spatial transcriptomics with clinically annotated bulk RNA-seq data to uncover spatially resolved biomarkers predictive of patient outcomes. Leveraging Elastic Net regression combined with SHAP-based attribution, SpaPheno uniquely identifies spatial features at multiple scales—from tissue regions to specific cell types and individual spatial spots—that are associated with patient survival, tumor stage, and immunotherapy response. We demonstrate the robustness and generalizability of SpaPheno through comprehensive simulations and applications spanning primary liver cancer, clear cell renal cell carcinoma, breast cancer, and melanoma. Across these diverse settings, SpaPheno achieves high predictive accuracy while providing biologically meaningful and spatially precise interpretations. Our framework offers a powerful and extensible approach for translating complex spatial omics data into actionable clinical insights, accelerating the development of precision oncology strategies grounded in tumor spatial architecture.</p>
<div class="figure" style="text-align: center">
<img src="./reference/figures/workflow.jpg" alt="The Overview of SpaPheno" width="80%" height="80%"><p class="caption">
The Overview of SpaPheno
</p>
</div>
</div>
<div class="section level2">
<h2 id="sunny-key-features">
<span class="emoji" data-emoji="sunny">☀️</span> Key Features<a class="anchor" aria-label="anchor" href="#sunny-key-features"></a>
</h2>
<ul>
<li><p><strong>Integration of spatial transcriptomics with clinically annotated bulk RNA-seq data</strong></p></li>
<li><p><strong>Multi-scale interpretable machine learning framework</strong></p></li>
<li><p><strong>Robust applicability across diverse cancer types and clinical endpoints</strong></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="arrow_double_down-installation">
<span class="emoji" data-emoji="arrow_double_down">⏬</span> Installation<a class="anchor" aria-label="anchor" href="#arrow_double_down-installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Install suggested packages</span></span>
<span><span class="co"># BiocManager::install(c(</span></span>
<span><span class="co">#   "glmnet",</span></span>
<span><span class="co">#   "FNN",</span></span>
<span><span class="co">#   "survival"</span></span>
<span><span class="co"># ))</span></span>
<span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="co"># devtools::install_github("bm2-lab/SpaDo")</span></span>
<span></span>
<span><span class="co"># SpaPheno installation</span></span>
<span><span class="co"># devtools::install_github("Duan-Lab1/SpaPheno", dependencies = c("Depends", "Imports", "LinkingTo"))</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Duan-Lab1/SpaPheno">SpaPheno</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rocket-quick-start">🚀 Quick Start<a class="anchor" aria-label="anchor" href="#rocket-quick-start"></a>
</h2>
<div class="section level3">
<h3 id="data-availability">Data availability<a class="anchor" aria-label="anchor" href="#data-availability"></a>
</h3>
<p>The data required for the test are all listed in the following google cloud directory <a href="https://drive.google.com/drive/folders/1tiSgMjhzvIsirvJwFDIAQIEIhR7qixUW?usp=drive_link" class="external-link">SpaPheno Demo Data</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>├── BRCAsurvival.RData</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>├── HCC_stage.RData</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>├── HCC_survival.RData</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>├── KIRC_survival.RData</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>├── Melanoma_ICB.RData</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>├── Simulation_osmFISH.RData</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>└── Simulation_STARmap.RData</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="book-vignette">
<span class="emoji" data-emoji="book">📖</span> Vignette<a class="anchor" aria-label="anchor" href="#book-vignette"></a>
</h2>
<p>Using the following command and Choosing the <code>html</code> for more details.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"SpaPheno"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sparkling_heart-contributing">
<span class="emoji" data-emoji="sparkling_heart">💖</span> Contributing<a class="anchor" aria-label="anchor" href="#sparkling_heart-contributing"></a>
</h2>
<p>Welcome any contributions or comments, and you can file them <a href="https://github.com/Duan-Lab1/SpaPhenoissues">here</a>.</p>
</div>
<div class="section level2">
<h2 id="trophy-acknowledgement">
<span class="emoji" data-emoji="trophy">🏆</span> Acknowledgement<a class="anchor" aria-label="anchor" href="#trophy-acknowledgement"></a>
</h2>
<p>Thanks all the developers of the methods integrated into <strong>SpaPheno</strong>.</p>
</div>
<div class="section level2">
<h2 id="eight_pointed_black_star-citation">
<span class="emoji" data-emoji="eight_pointed_black_star">✴️</span> Citation<a class="anchor" aria-label="anchor" href="#eight_pointed_black_star-citation"></a>
</h2>
<p>Kindly cite by using <code>citation("SpaPheno")</code> if you think <strong>SpaPheno</strong> helps you. Alternative way is Bin Duan (2025). <em>SpaPheno: Linking Spatial Transcriptomics to Clinical Phenotypes with Interpretable Machine Learning</em>. R package version 0.0.1, &lt;URL:<a href="https://github.com/Duan-Lab1/SpaPheno" class="uri">https://github.com/Duan-Lab1/SpaPheno</a>&gt;.</p>
</div>
<div class="section level2">
<h2 id="writing_hand-authors">
<span class="emoji" data-emoji="writing_hand">✍️</span> Authors<a class="anchor" aria-label="anchor" href="#writing_hand-authors"></a>
</h2>
<ul>
<li><p><a href="mailto:binduan@sjtu.edu.cn">Bin Duan</a></p></li>
<li><p><a href="mailto:zouhua1@outlook.com">Hua Zou</a></p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Duan-Lab1/SpaPheno/">Browse source code</a></li>
<li><a href="https://github.com/Duan-Lab1/SpaPheno/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SpaPheno</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Bin Duan <br><small class="roles"> Author, maintainer </small>  </li>
<li>Hua Zou <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Duan, Hua Zou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
